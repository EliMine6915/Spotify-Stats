<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trackify - Dashboard</title>
        <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="app">
      <div id="screenDashboard" class="dashboard">
        <aside class="sidebar">
          <div class="brand">
            <div class="brand-mark">
              <svg width="24" height="24" viewBox="0 0 236.05 225.25" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M122.37,3.31C61.99.91,11.1,47.91,8.71,108.29c-2.4,60.38,44.61,111.26,104.98,113.66,60.38,2.4,111.26-44.6,113.66-104.98C229.74,56.59,182.74,5.7,122.37,3.31Zm46.18,160.28c-1.36,2.4-4.01,3.6-6.59,3.24-.79-.11-1.58-.37-2.32-.79-14.46-8.23-30.22-13.59-46.84-15.93-16.62-2.34-33.25-1.53-49.42,2.4-3.51.85-7.04-1.3-7.89-4.81-.85-3.51,1.3-7.04,4.81-7.89,17.78-4.32,36.06-5.21,54.32-2.64,18.26,2.57,35.58,8.46,51.49,17.51,3.13,1.79,4.23,5.77,2.45,8.91Zm14.38-28.72c-2.23,4.12-7.39,5.66-11.51,3.43-16.92-9.15-35.24-15.16-54.45-17.86-19.21-2.7-38.47-1.97-57.26,2.16-1.02.22-2.03.26-3.01.12-3.41-.48-6.33-3.02-7.11-6.59-1.01-4.58,1.89-9.11,6.47-10.12,20.77-4.57,42.06-5.38,63.28-2.4,21.21,2.98,41.46,9.62,60.16,19.74,4.13,2.23,5.66,7.38,3.43,11.51Zm15.94-32.38c-2.1,4.04-6.47,6.13-10.73,5.53-1.15-.16-2.28-.52-3.37-1.08-19.7-10.25-40.92-17.02-63.07-20.13-22.15-3.11-44.42-2.45-66.18,1.97-5.66,1.15-11.17-2.51-12.32-8.16-1.15-5.66,2.51-11.17,8.16-12.32,24.1-4.89,48.74-5.62,73.25-2.18,24.51,3.44,47.99,10.94,69.81,22.29,5.12,2.66,7.11,8.97,4.45,14.09Z" fill="#1ed760"/>
              </svg>
            </div>
            <div class="brand-text">
              <div class="brand-title">Trackify</div>
              <div class="brand-subtitle">Usage</div>
            </div>
          </div>

          <nav class="nav">
            <button class="nav-item">
              <i class="ph ph-squares-four nav-icon"></i>
              Overview
            </button>
            <button class="nav-item">
              <i class="ph ph-user nav-icon"></i>
              Library
            </button>
            <button class="nav-item active">
              <i class="ph ph-chart-bar nav-icon"></i>
              Usage
            </button>
            <button class="nav-item">
              <i class="ph ph-gear nav-icon"></i>
              Settings
            </button>
          </nav>

          <div class="sidebar-footer">
            <a class="link" href="https://developer.spotify.com/dashboard" target="_blank" rel="noreferrer">Docs</a>
            <span class="sep">•</span>
            <span class="mono" id="redirectUriDash">...</span>
          </div>
        </aside>

        <div class="main">
          <header class="topbar">
            <div class="topbar-left">
              <h1 class="page-title">Usage</h1>
              <div id="rangePills" class="pill-row" role="tablist" aria-label="Zeitraum">
                <button class="pill active" data-range="7" type="button">7 days</button>
                <button class="pill" data-range="30" type="button">30 days</button>
                <button class="pill" data-range="90" type="button">90 days</button>
              </div>
            </div>

            <div class="topbar-right">
              <button id="uploadBtn" class="btn btn-secondary" type="button">
                <i class="ph ph-upload-simple"></i>
                Upload
              </button>

              <button id="exportBtn" class="btn btn-secondary" type="button">
                <i class="ph ph-download-simple"></i>
                Export
              </button>

              <div class="user">
                <div id="userBadge" class="user-badge">?</div>
                <div class="user-meta">
                  <div id="userName" class="user-name">—</div>
                </div>
                <i class="ph ph-sign-out logout-icon" id="logoutIcon" style="transition: color 0.2s;" onmouseover="this.style.color='#ff4444'" onmouseout="this.style.color='rgba(255, 255, 255, 0.7)'"></i>
              </div>
            </div>
          </header>

          <div id="dashStatus" class="status"></div>

          <!-- Miniplayer -->
          <section id="miniplayer" class="miniplayer hidden">
            <div class="miniplayer-content">
              <div class="miniplayer-cover">
                <img id="miniplayerImage" src="" alt="Cover" />
              </div>
              <div class="miniplayer-info">
                <div id="miniplayerTrack" class="miniplayer-track">—</div>
                <div id="miniplayerArtist" class="miniplayer-artist">—</div>
              </div>
              <div class="miniplayer-controls">
                <button id="previousBtn" class="control-btn" title="Previous">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="19 18 9 12 19 6"></polygon>
                    <line x1="5" y1="6" x2="5" y2="18"></line>
                  </svg>
                </button>
                <button id="playPauseBtn" class="control-btn" title="Play/Pause">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                  </svg>
                </button>
                <button id="nextBtn" class="control-btn" title="Next">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 18 15 12 5 6"></polygon>
                    <line x1="19" y1="6" x2="19" y2="18"></line>
                  </svg>
                </button>
              </div>
              <div class="miniplayer-status">
                <div class="miniplayer-indicator playing"></div>
                <span>Currently playing</span>
              </div>
            </div>
            <div class="miniplayer-progress-bar" id="miniplayerProgressBar">
              <div class="miniplayer-progress-fill" id="miniplayerProgressFill"></div>
            </div>
          </section>

          <section class="kpis">
            <div class="kpi">
              <div class="kpi-label">Tracks played</div>
              <div id="kpiPlays" class="kpi-value">—</div>
              <div id="kpiPlaysSub" class="kpi-sub">—</div>
            </div>
            <div class="kpi">
              <div class="kpi-label">Minutes listened</div>
              <div id="kpiMinutes" class="kpi-value">—</div>
              <div id="kpiMinutesSub" class="kpi-sub">—</div>
            </div>
            <div class="kpi">
              <div class="kpi-label">Unique artists</div>
              <div id="kpiArtists" class="kpi-value">—</div>
              <div id="kpiArtistsSub" class="kpi-sub">—</div>
            </div>
            <div class="kpi">
              <div class="kpi-label">Top track (recent)</div>
              <div id="kpiTopTrack" class="kpi-value">—</div>
              <div id="kpiTopTrackSub" class="kpi-sub">—</div>
            </div>
          </section>

          <section class="panel" style="flex: 1 1 0; min-height: 340px;">
            <div class="panel-header">
              <div>
                <div class="panel-title">Usage</div>
                <div class="panel-subtitle">Plays per day in selected period</div>
              </div>
            </div>
            <div class="chart-wrap" id="chartWrap">
              <canvas id="usageChart"></canvas>
            </div>
          </section>

          <section class="two-col">
            <section class="panel">
              <div class="panel-header">
                <div>
                  <div class="panel-title">Top artists</div>
                  <div class="panel-subtitle">Spotify long term</div>
                </div>
              </div>
              <ol id="topArtists" class="list"></ol>
            </section>

            <section class="panel">
              <div class="panel-header">
                <div>
                  <div class="panel-title">Top tracks</div>
                  <div class="panel-subtitle">Spotify long term</div>
                </div>
              </div>
              <ol id="topTracks" class="list"></ol>
            </section>
          </section>
        </div>
      </div>
    </div>

    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="app.js" defer></script>

    <!-- Upload Dialog -->
    <div id="uploadDialog" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Import Spotify History</h3>
          <button id="closeUploadDialog" class="btn-close">&times;</button>
        </div>
        <div class="modal-body">
          <div class="import-section">
            <div class="drop-zone" id="dropZone">
              <div class="drop-zone-content">
                <i class="ph ph-upload-simple drop-zone-icon"></i>
                <p class="drop-zone-text">Drag & drop your Spotify history files here</p>
                <p class="drop-zone-subtext">or</p>
                <button id="selectFilesBtn" class="btn btn-login">Browse Files</button>
              </div>
              <input type="file" id="fileInput" multiple accept=".json" style="display: none;">
            </div>
            <div id="fileList" class="file-list"></div>
            <div id="uploadProgress" class="upload-progress" style="display: none;">
              <div class="progress-bar">
                <div id="progressBar" class="progress-fill"></div>
              </div>
              <div id="progressText" class="progress-text">Uploading...</div>
            </div>
            <div id="uploadResults" class="upload-results"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Logout Modal -->
    <div id="logoutModal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Logout</h3>
          <button id="closeLogoutModal" class="btn-close">&times;</button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to logout?</p>
          <div class="modal-actions">
            <button id="cancelLogout" class="btn btn-secondary">Cancel</button>
            <button id="confirmLogout" class="btn btn-primary">Logout</button>
          </div>
        </div>
      </div>
    </div>

  </div>
  </body>
</html>
